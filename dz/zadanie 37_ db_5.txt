Таблица Client:
INNClient - идентификационный номер клиента (первичный ключ)
Client – клиент
Status - место продажи

Таблица ClientGoods:
IDParty – (первичный ключ)
ID – (внешний ключ)
INNClient – идентификационный номер клиента (внешний ключ)
CostUnit – стоимость за единицу 
Count - количество приобретенного товара

Таблица SallerGoods:
ID – (первичный ключ)
Code – код товара
INNSeller – идентификационный код продавца (внешний ключ)
DateStart – дата
Goods – товар
CostUnit – стоимость за единицу
Count - количество товара на складе

Таблица Seller:
INNSeller - идентификационный код продавца (первичный ключ)
Seller – продавец
Status - статус



1.	Сосчитать количество клиентов, покупающих товар.
SELECT COUNT(Client) AS [Количество клиентов]
FROM Client

2.	Сколько посредников поставляют товар для фирмы.

SELECT COUNT(Seller) AS 'Количество посредников'
FROM Seller
WHERE Status LIKE 'посредник'

3.	Вывести среднюю сумму сделки по проданному товару.

SELECT AVG(CostUnit * Count ) AS 'Сумма товара'
FROM ClientGoods

4.	Посчитать на какую сумму было всего поставлено товара.

SELECT SUM(CostUnit * Count ) AS 'Сумма товара'
FROM ClientGoods

5.	Определите максимальное количество закупленного товара шт.(кг)

SELECT MAX(Count ) AS 'Максимальнре кол-во товара'
FROM SallerGoods



6.	Какая минимальная сумма покупки, на которую клиент сделал заказ.

SELECT MIN(Count * CostUnit ) AS 'Минимальная сумма покупки'
FROM ClientGoods

7.	Посчитать на какую сумму было продано товара магазинам.

SELECT SUM(cg.Count * cg.CostUnit) AS 'сумма'
FROM Client c, ClientGoods cg
WHERE c.INNClient=cg.INNClient AND c.Status='магазин'

8.	Сосчитать общее количество видов закупленных фирмой вафель.
SELECT COUNT(sg.Goods) AS 'Количество печенья'
FROM SallerGoods sg, Client c, ClientGoods cg
WHERE c.INNClient=cg.INNClient AND cg.ID=sg.ID AND Goods LIKE 'Вафли%'


9.	Выведите среднюю цену на растительное масло (закупочную).
SELECT AVG(CostUnit) AS 'Средняя цена'
FROM SallerGoods
WHERE Goods LIKE 'масло подсолнечное'

10.	Определите сколько всего было продано килограмм яблок.
SELECT SUM(Count) AS 'Всего кг'
FROM SallerGoods
WHERE Goods LIKE 'Яблоки%'

11.	Определите какое количество картофеля закупили кафе.
SELECT SUM(cg.Count) AS 'Всего кг'
FROM Client c, ClientGoods cg, SallerGoods sg
WHERE c.INNClient=cg.INNClient AND cg.ID=sg.ID AND sg.Goods LIKE 'Картофель%' AND c.Status LIKE 'кафе' 


12.	Посчитать сколько клиентов купили перец черный молотый.
SELECT COUNT(c.Client) AS 'Всего клиентов'
FROM Client c, ClientGoods cg, SallerGoods sg
WHERE c.INNClient=cg.INNClient AND cg.ID=sg.ID AND sg.Goods LIKE 'Перец черный молотый'

13.	Определить сколько наименований товара было куплено у посредников.
SELECT COUNT( DISTINCT sg.Goods ) AS 'Всего наименований товаров'
FROM ClientGoods cg, SallerGoods sg, Seller s             b
WHERE cg.ID=sg.ID AND sg.INNSeller=s.INNSeller AND s.Status LIKE 'посредник'

14.	Определить минимальную цену за единицу проданного товара.
SELECT MIN(CostUnit) AS 'минимальная цена'
FROM ClientGoods

15.	Определите минимальную сумму на какую было закуплено товара.
SELECT MIN(CostUnit*Count) AS 'минимальная сумма'
FROM SallerGoods


16.	Определить максимальную сумму за товар, проданный магазинам.
SELECT MAX(cg.CostUnit*cg.Count) AS 'максимальная сумма'
FROM Client c, ClientGoods cg
WHERE c.INNClient=cg.INNClient AND c.Status LIKE 'магазин'

17.	Определить со сколькими фирмами сотрудничает данная фирма.
SELECT COUNT(DISTINCT c.Client) AS 'Количество фирм'
FROM SallerGoods sg, Client c, ClientGoods cg, Seller s
WHERE c.INNClient=cg.INNClient AND cg.ID=sg.ID AND sg.INNSeller=s.INNSeller AND s.INNSeller LIKE '1007'


18.	Определить минимальную сумму сделки по закупке товара у производителей.
SELECT MIN(cg.CostUnit*cg.Count) AS 'минимальная сумма'
FROM Client c, ClientGoods cg, SallerGoods sg, Seller s
WHERE c.INNClient=cg.INNClient AND cg.ID=sg.ID AND sg.INNSeller=s.INNSeller AND s.Status LIKE 'производитель'

19.	Определить среднюю цену за пачку чая при покупке.
SELECT AVG(cg.CostUnit) AS 'Средняя цена'
FROM ClientGoods cg, SallerGoods sg
WHERE cg.ID=sg.ID AND sg.Goods LIKE 'Чай%'


20.	Определите максимальную сумму прибыли за товар, проданный посреднику.
SELECT MAX(cg.CostUnit*cg.Count) AS 'Максимальная прибыль'
FROM Client c, ClientGoods cg
WHERE c.INNClient=cg.INNClient AND c.Status LIKE 'посредник'

21.	 Определите минимальную прибыль за товар, купленный у посредника.
SELECT MIN(cg.CostUnit*cg.Count) AS 'Минимальная прибыль'
FROM Client c, ClientGoods cg, SallerGoods sg, Seller s
WHERE c.INNClient=cg.INNClient AND cg.ID=sg.ID AND sg.INNSeller=s.INNSeller AND s.Status LIKE 'посредник'

22.	 Какое количество наименований товара куплено у фирмы.
SELECT COUNT(DISTINCT sg.Goods) AS 'Количество товара'
FROM ClientGoods cg, SallerGoods sg
WHERE cg.ID=sg.ID

23.	 Сколько в продаже видов печенья.
SELECT COUNT(Goods) AS 'Количество печенья'
FROM SallerGoods
WHERE Goods LIKE 'Печенье%'

24.	 Какая максимальная сумма покупки, на которую клиент сделал заказ.
SELECT MAX(cg.CostUnit*cg.Count) AS 'Максимальная покупка'
FROM Client c, ClientGoods cg
WHERE c.INNClient=cg.INNClient

25.	 Определите среднюю прибыль от перепродажи масла.
SELECT AVG(cg.CostUnit*cg.Count) AS 'Средняя прибыль'
FROM Client c, ClientGoods cg, SallerGoods sg
WHERE c.INNClient=cg.INNClient AND cg.ID=sg.ID AND sg.Goods LIKE 'масло%'


26.	 Со сколькими посредниками сотрудничает фирма.
SELECT COUNT(DISTINCT c.Client) AS 'Количество фирм'
FROM SallerGoods sg, Client c, ClientGoods cg, Seller s
WHERE c.INNClient=cg.INNClient AND cg.ID=sg.ID AND sg.INNSeller=s.INNSeller AND c.Status LIKE 'посредник'

